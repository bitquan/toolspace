name: Seed Labels

on:
    workflow_dispatch:

jobs:
    seed-labels:
        name: Create Repository Labels
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v5

            - name: Create labels
              uses: actions/github-script@v8
              with:
                  script: |
                      const labels = [
                        // Priority labels
                        { name: 'P0-blocker', color: 'd73a4a', description: 'Critical blocker - breaks money/data/auth' },
                        { name: 'P1', color: 'fbca04', description: 'High priority - user-visible issue' },
                        { name: 'P2', color: '0e8a16', description: 'Medium priority - polish/performance' },
                        { name: 'P3', color: 'cccccc', description: 'Low priority - nice to have' },
                        
                        // Tool-specific labels
                        { name: 'tool:quick-invoice', color: '1f76b4', description: 'Quick Invoice tool' },
                        { name: 'tool:text-tools', color: '9467bd', description: 'Text Tools utility' },
                        { name: 'tool:file-merger', color: '2ca02c', description: 'File Merger tool' },
                        
                        // Area labels
                        { name: 'area:backend', color: 'e377c2', description: 'Backend/Functions code' },
                        { name: 'area:frontend', color: '17becf', description: 'Frontend/Flutter code' },
                        { name: 'area:devops', color: '8c564b', description: 'CI/CD and infrastructure' },
                        { name: 'area:docs', color: 'f7931e', description: 'Documentation' },
                        { name: 'area:security', color: 'ff6b6b', description: 'Security-related' },
                        
                        // Type labels
                        { name: 'type:bug', color: 'd73a4a', description: 'Something is broken' },
                        { name: 'type:feature', color: '0e8a16', description: 'New feature request' },
                        { name: 'type:enhancement', color: '1d76db', description: 'Improvement to existing feature' },
                        { name: 'type:task', color: 'fbca04', description: 'General task or chore' },
                        { name: 'type:question', color: 'cc317c', description: 'Question or discussion' },
                        
                        // Status labels  
                        { name: 'status:blocked', color: 'b60205', description: 'Blocked by external dependency' },
                        { name: 'status:in-review', color: 'fbca04', description: 'Under review' },
                        { name: 'status:needs-info', color: 'd4c5f9', description: 'Needs more information' },
                        
                        // Size labels
                        { name: 'size:xs', color: 'c2e0c6', description: 'Extra small change' },
                        { name: 'size:s', color: '7ed321', description: 'Small change' },
                        { name: 'size:m', color: 'fbca04', description: 'Medium change' },
                        { name: 'size:l', color: 'f5a623', description: 'Large change' },
                        { name: 'size:xl', color: 'd0021b', description: 'Extra large change' }
                      ];

                      for (const label of labels) {
                        try {
                          await github.rest.issues.createLabel({
                            owner: context.repo.owner,
                            repo: context.repo.repo,
                            name: label.name,
                            color: label.color,
                            description: label.description
                          });
                          console.log(`✅ Created label: ${label.name}`);
                        } catch (error) {
                          if (error.status === 422) {
                            console.log(`⚠️  Label already exists: ${label.name}`);
                          } else {
                            console.log(`❌ Error creating label ${label.name}:`, error.message);
                          }
                        }
                      }
